<div xmlns="http://www.w3.org/1999/xhtml" xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  metal:use-macro="api.community_layout.macros['master']">

  <div metal:fill-slot="content">

    <div metal:use-macro="api.snippets.macros['status_message']"/>
    <div metal:use-macro="api.snippets.macros['error_message']"/>
    <div metal:use-macro="api.snippets.macros['actions_box']"/>

    <h1>${api.page_title}</h1>

    <p>Use the form below to remove members or to resend invites to
    people who have not accepted your invitation to join this
    community.</p>

    <form method="post" action="${post_url}" class="k3_genericForm">

    <div metal:use-macro="formfields.macros['formerror']"/>

      <div tal:condition="results">
	<h2>Results</h2>
	<ul>
	  <li tal:repeat="result results">${result}</li>
	</ul>
      </div>

      <table class="content-listing">
        <thead>
          <tr>
            <th style="text-align: center">Name</th>
            <th style="text-align: center">Moderator</th>
            <th style="text-align: center">Resend Info</th>
            <th style="text-align: center">Remove</th>
          </tr>
        </thead>
        <tbody>
	  <tal:block repeat="typ ['moderators', 'members', 'invitations']">
	    <tal:block repeat="entry entries[typ]">
	      <tr tal:define="pos repeat['entry'].number()">

		<td>
		  <span title="${entry['id']}">${entry['title']}</span>
		  <input type="hidden" name="${typ}-${pos}.id" 
			 value="${entry['id']}"/>
		</td>

                <td align="center">
		  <tal:block condition="typ!='invitations' and (len(entries['moderators']) > 1 or typ=='members')">
		    <input tal:attributes="checked entry['is_moderator']"
			   type="checkbox" name="${typ}-${pos}.is_moderator"/>
		  </tal:block>
		  <tal:block condition="len(entries['moderators']) == 1 and typ=='moderators'">
		    <!-- Don't allow deletion of the last moderator -->
		    <span>Sole Moderator</span>
		    <input type="hidden" name="${typ}-${pos}.is_moderator" 
			   value="1"/>
		  </tal:block>
		</td>
                <td align="center">
		  <input tal:condition="typ=='invitations'"
			 type="checkbox" name="${typ}-${pos}.resend_info" 
			 value="${entry['resend_info']}"/>
		</td>
                <td align="center">
                  <tal:block condition="len(entries['moderators']) > 1 and typ=='moderators'">
                    <input name="${typ}-${pos}.remove" type="checkbox"
                           value="${entry['remove']}"/>
                  </tal:block>
                  <tal:block condition="typ=='members'">
                    <input name="${typ}-${pos}.remove" type="checkbox"
                           value="${entry['remove']}"/>
                  </tal:block>
                  <tal:block condition="typ=='invitations'">
                    <input name="${typ}-${pos}.remove" type="checkbox"
                           value="${entry['remove']}"/>
                  </tal:block>
		</td>
	      </tr>
	    </tal:block>
	  </tal:block>
        </tbody>
      </table>
      <fieldset metal:use-macro="formfields.macros['form-submit']"/>      
    </form>

  </div>

</div>
