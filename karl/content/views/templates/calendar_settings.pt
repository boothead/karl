<?xml version="1.0" encoding="utf-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"
     xmlns:tal="http://xml.zope.org/namespaces/tal"
     xmlns:metal="http://xml.zope.org/namespaces/metal"
     metal:use-macro="api.community_layout.macros['master']">

  <div metal:fill-slot="content">

    <div metal:use-macro="api.snippets.macros['status_message']"/>

    <h1 class="kscreentitle">${api.page_title}</h1>

  <form method="post" action="${post_url}" class="k3_genericForm"
        xml:id="contentform" enctype="multipart/form-data" name="save">

    <div metal:use-macro="formfields.macros['formerror']"/>

    <table id="calendars" border="0">

      <tr tal:condition="manifest">
        <th>Color</th>
        <th>Name</th>
        <th>Location</th>
        <th>Delete</th>
      </tr>

      <tr tal:repeat="calendar manifest">
         <td style="background-color: ${calendar['color']}">&nbsp;</td>
         <td>${calendar['name']}</td>
         <td>${calendar['title']}</td>
         <td><a href="${post_url}?form.delete=${calendar['escaped_name']}"
                >delete</a></td>
       </tr>

     </table>

    <fieldset tal:define="error fielderrors['calendar_name']|None"
              class="${error and 'fieldError' or ''}"
              id="virtual-calendars-field">

      <h2>Add Calendar</h2>

      <div tal:condition="error" class="errorMessage">${error}</div> 

      <label for="calendar_path" class="required">
        Calendar Location
      </label>
      <select name="calendar_path">
        <option value="">Local</option>
        <option tal:repeat="calendar remote_calendars"
                value="${calendar['path']}">${calendar['title']}</option>
      </select>
      <br/>

      <label for="calendar_name" class="required">
        Name the calendar
      </label>
      <input name="calendar_name" type="text"/>

      <br/>

      <label for="calendar_color" class="required">
        Choose color
      </label>

      <table border="0">

        <tr>
          <td tal:repeat="color colors">
            <input name="calendar_color"
                   type="radio" value="${color}" alt="${color}"/>
            <br/>
            <div style="background-color: ${color}">&nbsp;</div>
          </td>
        </tr>
      </table>

    </fieldset>

    <fieldset metal:use-macro="formfields.macros['form-submit']"/>

  </form>

  </div>
</html>
